#!/usr/bin/env bash

# This bash completions script was generated by
# completely (https://github.com/dannyben/completely)
# Modifying it manually is not recommended
_<%= command %>_completions() {
  local cur prev
  cur=${COMP_WORDS[COMP_CWORD]}
  prev=${COMP_WORDS[*]:1:$COMP_CWORD-1}

  if [[ $COMP_CWORD == 1 ]]; then
    COMPREPLY=($(compgen -W "<%= root_words.join " " %>" -- "$cur"))
  
  elif [[ $COMP_CWORD -gt 1 ]]; then
    case "$prev" in    
<%- patterns.each do |pattern, words| -%>
<%-
  next unless words
  clean_words = words.reject { |w| w =~ /^<.*>$/ }.join " "
  functions = words.filter_map { |w| func = w[/^<(.+)>$/, 1] ; "-A #{func}" if func }
  flags = functions.any? ? "#{functions.join ' '} -W" : "-W"
-%>
      "<%= pattern %>") COMPREPLY=($(compgen <%= flags %> "<%= clean_words %>" -- "$cur")) ;;
<%- end -%>
    esac
  
  else
    COMPREPLY=()
  
  fi
}

complete -F _<%= command %>_completions <%= command %>
